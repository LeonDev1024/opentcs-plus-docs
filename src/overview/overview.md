# 项目概述

## 系统架构

OpenTCS Plus 采用模块化设计，整个系统由以下核心模块组成：

### 核心模块

#### 1. opentcs-admin
系统管理后台，提供系统启动、配置管理和基础服务。

#### 2. opentcs-common
通用工具和基础组件模块，包含：
- 通用工具类
- 基础实体类
- 公共异常处理
- 工具函数库

#### 3. opentcs-module-system
系统管理模块，提供：
- **用户管理** - 用户信息、角色权限、组织架构
- **权限管理** - 菜单权限、按钮权限、数据权限
- **系统配置** - 参数配置、系统开关、邮件/SMS配置
- **日志管理** - 操作日志、登录日志、系统日志

#### 4. opentcs-module-map
地图管理模块，提供：
- **地图管理** - 地图创建/编辑、版本管理、导入/导出
- **点位管理** - 点位创建/编辑、类型管理、属性配置
- **路径管理** - 路径创建/编辑、方向设置、属性配置
- **位置管理** - 位置点管理、类型定义、属性配置
- **区域管理** - 区域定义、权限控制、冲突检测
- **地图工具** - 拓扑验证、连通性检查、坐标转换

#### 5. opentcs-module-vehicles
车辆管理模块，提供：
- **车辆注册** - 车辆信息录入、类型定义、属性配置
- **状态监控** - 实时位置跟踪、状态变化记录、电池监控
- **车辆控制** - 运动控制、停止/暂停、充电控制
- **车辆配置** - 参数配置、运动参数、通信参数
- **车辆统计** - 运行时长、任务完成、故障统计

#### 6. opentcs-module-task
订单任务模块，提供：
- **任务创建** - 手动创建、批量创建、任务模板
- **任务调度** - 优先级管理、分配策略、队列管理
- **任务执行** - 状态跟踪、进度监控、异常处理
- **任务历史** - 完成记录、效率统计、报表生成
- **任务优化** - 批量优化、路径优化、资源利用优化

#### 7. opentcs-module-algorithm
算法模块，提供：
- **路径规划算法** - A*算法、D* Lite算法、多目标优化
- **任务分配算法** - 匈牙利算法、遗传算法、负载均衡
- **交通控制算法** - 冲突检测、死锁避免、交通流优化

#### 8. opentcs-module-driver
车辆驱动模块，提供：
- **驱动框架** - 驱动管理器、生命周期管理、工厂模式
- **协议支持** - TCP Socket、MQTT、HTTP REST API、串口通信
- **消息处理** - 消息编解码、队列管理、超时重试
- **设备适配** - AGV适配器、机器人适配器、通用设备接口
- **连接管理** - 连接池、断线重连、心跳检测

#### 9. opentcs-module-job
Job 任务管理模块，提供：
- **定时任务** - Cron表达式支持、任务调度器、状态管理
- **异步任务** - 异步执行、进度查询、结果回调
- **任务类型** - 数据同步、报表生成、系统清理、监控检查
- **任务管理** - 配置管理、依赖管理、优先级设置

#### 10. opentcs-module-monitor
监控模块，提供：
- **系统监控** - 系统状态、健康检查、性能指标
- **车辆监控** - 车辆状态、位置轨迹、运行参数
- **任务监控** - 任务执行、进度显示、效率统计
- **告警管理** - 告警规则、级别定义、通知方式
- **报表统计** - 运行报表、统计图表、数据导出

## 技术架构

### 后端架构

```
┌─────────────────────────────────────────┐
│         opentcs-admin (启动模块)         │
└─────────────────────────────────────────┘
                    │
        ┌───────────┴───────────┐
        │                       │
┌───────▼────────┐    ┌─────────▼────────┐
│  System Module │    │   Map Module     │
└────────────────┘    └──────────────────┘
        │                       │
┌───────▼────────┐    ┌─────────▼────────┐
│ Vehicle Module │    │  Task Module     │
└────────────────┘    └──────────────────┘
        │                       │
┌───────▼────────┐    ┌─────────▼────────┐
│Algorithm Module│    │ Driver Module    │
└────────────────┘    └──────────────────┘
        │                       │
┌───────▼────────┐    ┌─────────▼────────┐
│  Job Module    │    │ Monitor Module   │
└────────────────┘    └──────────────────┘
```

### 前端架构

```
┌─────────────────────────────────────────┐
│          Vue 3 + TypeScript              │
├─────────────────────────────────────────┤
│  Router  │  Pinia  │  Element Plus      │
├─────────────────────────────────────────┤
│          API 接口层                      │
├─────────────────────────────────────────┤
│    业务模块 (地图、车辆、任务、监控)      │
└─────────────────────────────────────────┘
```

## 数据流

### 任务调度流程

```
用户创建任务
    ↓
任务验证和预处理
    ↓
任务分配算法
    ↓
路径规划算法
    ↓
车辆驱动执行
    ↓
实时监控和反馈
    ↓
任务完成记录
```

### 车辆控制流程

```
控制命令下发
    ↓
驱动模块处理
    ↓
协议转换和发送
    ↓
车辆执行
    ↓
状态反馈
    ↓
状态更新和监控
```

## 性能指标

### 系统性能

- **系统响应时间**: < 2秒
- **并发用户数**: ≥ 50
- **地图加载时间**: < 3秒
- **路径规划时间**: < 1秒
- **数据持久化**: 事务完整性保证

### 质量指标

- **单元测试覆盖率**: ≥ 70%
- **API 文档完整度**: 100%
- **代码规范符合度**: ≥ 95%
- **系统可用性**: ≥ 99.5%

## 开发优先级

### 第一阶段 (1-4周): 基础框架
- opentcs-admin - 系统启动和基础配置
- opentcs-common - 通用工具和基础组件
- opentcs-module-system - 用户权限管理

### 第二阶段 (5-8周): 核心数据
- opentcs-module-map - 地图模型管理
- opentcs-module-vehicles - 车辆基础管理

### 第三阶段 (9-12周): 调度核心
- opentcs-module-algorithm - 基础算法实现
- opentcs-module-task - 任务管理功能

### 第四阶段 (13-16周): 设备集成
- opentcs-module-driver - 设备驱动开发
- opentcs-module-job - 后台任务管理

### 第五阶段 (17-18周): 系统完善
- opentcs-module-monitor - 监控和报表功能

